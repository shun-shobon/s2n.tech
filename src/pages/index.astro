---
import { Image } from "astro:assets";

import HeroDeco from "@/assets/hero-deco.svg";
import Stars from "@/assets/stars.png";
import Header from "@/components/Header.astro";
import About from "@/features/about/About.astro";
import Footer from "@/features/about/Footer.astro";
import Links from "@/features/about/Links.astro";
import TimeLine from "@/features/about/TimeLine.astro";
import Works from "@/features/about/Works.astro";
import Layout from "@/layouts/Layout.astro";
---

<Layout class="bg-(image:--bg-night-sky)">
	<Fragment slot="head">
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap"
			rel="stylesheet"
		/>
	</Fragment>

	<div
		id="bg-container"
		class="fixed inset-0 -z-50 bg-(image:--bg-night-sky) bg-size-[100%_120%] bg-position-[50%_0%]"
	>
		<Image src={Stars} width={1920} alt="" class="h-full w-full object-cover" />
	</div>

	<div
		class="fixed top-0 left-0 isolate z-50 flex w-full justify-center p-4 sm:p-8"
	>
		<Header />
	</div>

	<div id="hero-container" class="relative h-svh w-full text-white">
		<div class="absolute inset-0 -z-40 p-2 sm:p-4">
			<div class="h-full w-full border-2 border-dashed border-white"></div>
		</div>

		<div class="absolute -inset-x-8 -top-8 hidden">
			<Image src={HeroDeco} alt="" class="h-auto w-full" />
		</div>

		<div class="grid h-full w-full place-items-center">
			<div
				class="grid -rotate-3 -skew-x-12 text-center font-cursive leading-none"
			>
				<h1 class="text-[clamp(2.5rem,10vw,8rem)]">Shuntaro Nishizawa</h1>
				<p class="text-[clamp(1.25rem,5vw,4rem)]">Web Frontend Developer</p>
			</div>
		</div>
	</div>

	<div class="pt-24 font-about-sans-serif leading-normal text-white">
		<!-- 見出しの線で利用するSVGフィルター -->
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 0 0"
			class="absolute top-0 left-0"
		>
			<defs>
				<filter id="heading-line-filter" color-interpolation-filters="sRGB">
					<feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood>
					<feBlend
						mode="normal"
						in="SourceGraphic"
						in2="BackgroundImageFix"
						result="shape"></feBlend>
					<feTurbulence
						type="fractalNoise"
						baseFrequency="0.25 0.25"
						numOctaves="10"></feTurbulence>
					<feDisplacementMap
						in="shape"
						scale="4"
						xChannelSelector="R"
						yChannelSelector="G"
						result="displacedImage"
						width="100%"
						height="100%"></feDisplacementMap>
					<feMerge>
						<feMergeNode in="displacedImage"></feMergeNode>
					</feMerge>
				</filter>
			</defs>
		</svg>

		<div class="grid gap-16 sm:gap-24">
			<About />
			<Works />
			<TimeLine />
			<Links />
			<Footer />
		</div>
	</div>
</Layout>
<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";

	gsap.registerPlugin(ScrollTrigger);

	const bgContainer = document.getElementById("bg-container")!;

	gsap.to(bgContainer, {
		scrollTrigger: {
			trigger: document.body,
			start: "top top",
			end: "bottom bottom",
			scrub: true,
		},
		backgroundPositionY: "100%",
	});
</script>
