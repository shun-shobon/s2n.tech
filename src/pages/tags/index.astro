---
import Tag from "@/components/Tag.astro";
import { getPosts } from "@/features/posts/repository";
import BasicLayout from "@/layouts/BasicLayout.astro";

const { posts } = await getPosts({
	draft: true,
});

const tagMap = new Map<string, number>();
for (const post of posts) {
	for (const tag of post.data.tags) {
		tagMap.set(tag, (tagMap.get(tag) ?? 0) + 1);
	}
}

const tags = Array.from(tagMap.entries()).sort((a, b) => b[1] - a[1]);
---

<BasicLayout title="タグ一覧">
	<div class="px-4 pb-4 sm:px-8 sm:pb-8">
		<div class="mx-auto grid w-full max-w-4xl gap-4 sm:gap-8">
			<h1 class="text-center text-2xl font-bold sm:text-4xl">タグ一覧</h1>
			<div
				class="bg-background-primary border-border flex flex-wrap gap-2 rounded-2xl border p-4 shadow-lg sm:px-8 sm:py-6"
			>
				{tags.map(([tag]) => <Tag tag={tag} />)}
			</div>
		</div>
	</div>
</BasicLayout>
